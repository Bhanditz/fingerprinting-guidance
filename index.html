<!DOCTYPE html>
<html>
  <head>
    <title>Fingerprinting Guidance for Web Specification Authors</title>
    <meta charset='utf-8'>
    <script src='https://www.w3.org/Tools/respec/respec-w3c-common' class='remove'></script>
    <script class='remove'>
      var respecConfig = {
          // specification status (e.g. WD, LCWD, NOTE, etc.). If in doubt use ED.
          specStatus:           "unofficial",
          
          // the specification's short name, as in http://www.w3.org/TR/short-name/
          shortName:            "fingerprinting-guidance",

          // if your specification has a subtitle that goes below the main
          // formal title, define it here
          // subtitle   :  "an excellent document",

          // if you wish the publication date to be other than today, set this
          // publishDate:  "2009-08-06",

          // if the specification's copyright date is a range of years, specify
          // the start date here:
          // copyrightStart: "2005"

          // if there is a previously published draft, uncomment this and set its YYYY-MM-DD date
          // and its maturity status
          // previousPublishDate:  "1977-03-15",
          // previousMaturity:  "WD",

          // if there a publicly available Editor's Draft, this is the link
          //edDraftURI:           "http://dev.w3.org/2009/dap/ReSpec.js/documentation.html",

          // if this is a LCWD, uncomment and set the end of its review period
          // lcEnd: "2009-08-05",

          // editors, add as many as you like
          // only "name" is required
          editors:  [
              { name: "Nick Doty", url: "http://npdoty.name/",
                company: "W3C", companyURL: "http://w3.org/" },
          ],

          // authors, add as many as you like. 
          // This is optional, uncomment if you have authors as well as editors.
          // only "name" is required. Same format as editors.

          //authors:  [
          //    { name: "Your Name", url: "http://example.org/",
          //      company: "Your Company", companyURL: "http://example.com/" },
          //],
          
          // name of the WG
          wg:           "Privacy Interest Group",
          
          // URI of the public WG page
          wgURI:        "http://w3.org/Privacy/",
          
          // name (without the @w3c.org) of the public mailing to which comments are due
          wgPublicList: "public-privacy",
          
          // URI of the patent status for this WG, for Rec-track documents
          // !!!! IMPORTANT !!!!
          // This is important for Rec-track documents, do not copy a patent URI from a random
          // document unless you know what you're doing. If in doubt ask your friendly neighbourhood
          // Team Contact.
          wgPatentURI:  "",
          
          localBiblio: {
            "EVERCOOKIE": {
              "authors": ["Samy Kamkar"],
              "href": "http://samy.pl/evercookie/",
              "title": "evercookie - virtually irrevocable persistent cookies",
              "date": "September 2010"
            },
            "NDSS-FINGERPRINTING": {
              "authors": ["Ting-Fang Yen", "Yinglian Xie", "Fang Yu", "Roger Peng Yu", "Martin Abadi"],
              "href": "http://research.microsoft.com/apps/pubs/default.aspx?id=156901",
              "title": "Host Fingerprinting and Tracking on the Web: Privacy and Security Implications",
              "date": "February 2012",
              "publisher": "In Proceedings of the Network and Distributed System Security Symposium (NDSS)"
            },
            "RFC6973": {
              "authors": [
                  "A. Cooper",
                  "H. Tschofenig",
                  "B. Aboba",
                  "J. Peterson",
                  "J. Morris",
                  "M. Hansen",
                  "R. Smith"
              ],
              "href": "http://www.rfc-editor.org/rfc/rfc6973.txt",
              "title": "Privacy Considerations for Internet Protocols",
              "date": "July 2013",
              "status": "RFC",
              "publisher": "IETF"
            },
            "WEBSTORAGE-user-tracking": {
              "href": "http://www.w3.org/TR/2013/REC-webstorage-20130730/#user-tracking",
              "title": "Web Storage > Privacy > User tracking",
              "date": "July 2013",
              "authors": [
                "Ian Hickson"
              ],
              "status": "Rec",
              "publisher": "W3C"
            },
            "TRACKING-DNT": {
              "href": "http://www.w3.org/TR/tracking-dnt/",
              "title": "Tracking Preference Expression (DNT)",
              "date": "September 2013",
              "authors": [
                "Roy Fielding", "David Singer"
              ],
              "status": "WD",
              "publisher": "W3C"
            },
            "TRACKING-COMPLIANCE": {
              "href": "http://www.w3.org/TR/tracking-compliance/",
              "title": "Tracking Compliance and Scope",
              "date": "September 2013",
              "authors": [
                "Justin Brookman", "Heather West", "Sean Harvey", "Erica Newland"
              ],
              "status": "WD",
              "publisher": "W3C"
            }
            
          }
      };
      </script>
      <style type="text/css" media="screen">
        img.fingerprint {
          float: left; 
          margin-left: -25px;
        }
      </style>
  </head>
  <body>
    <section id="abstract">
      Exposure of settings and characteristics of browsers can impact user privacy by allowing for browser fingerprinting. This document defines different types of fingerprinting, considers distinct levels of mitigation for the related privacy risks and provides guidance for Web specification authors on how to balance these concerns when designing new Web features.
    </section>
    <section id="sotd">
      This is a draft of a document intended to be published as an Interest Group Note. Constructive feedback of all kinds is welcomed; feel free to contact the editor directly or send comments to the <a href="mailto:public-privacy@w3.org">public-privacy</a> mailing list (<a href="https://lists.w3.org/Archives/Public/public-privacy/">public archives</a>).
    </section>
    <section id="bp-summary"></section>
    <section>
      <h2>What is fingerprinting?</h2>
      <p>In short, <dfn>browser fingerprinting</dfn> is the capability of a site to identify or re-identify a visiting user, user agent or device via configuration settings or other observable characteristics.</p>
      <p>A more detailed list of types of fingerprinting is included below. A similar definition is provided by [[RFC6973]].</p>
    
        <section>
        <h2 id="privacy_threat_models">Privacy impacts and threat models</h2>

        <p>Browser fingerprinting can be used as a security measure (e.g. as means of authenticating the user). However, fingerprinting is also a potential threat to users' privacy on the Web. This document does not attempt to provide a single unifying definition of "privacy" or "personal data", but we highlight how browser fingerprinting might impact users' privacy. For example, browser fingerprinting can be used to:</p>
        <ul>
          <li>identify a user</li>
          <li>track and correlate a user’s browsing activity within and across sessions</li>
          <li>collect information from which inferences can be drawn about a user</li>
        </ul>

        <p>The privacy implications associated with each use case are discussed below. Following from the practice of security threat model analysis, we note that there are distinct models of privacy threats for fingerprinting. Defenses against these threats differ, depending on the particular privacy implication and the threat model of the user.</p>

        <section>
          <h3>Identify a user</h3>
          <p>There are many reasons why users might wish to remain anonymous or unidentified online, including: concerns about surveillance, personal physical safety, concerns about discrimination against them based on what they read or write when using the Web. When a browser fingerprint is correlated with identifying information (like a real name), an application or service provider may be able to identify an otherwise pseudonymous user.</p>
          <p>Users concerned about physical safety from, for example, a governmental adversary might employ onion routing systems such as Tor to limit network-level linkability but still face the danger of browser fingerprinting to correlate their Web-based activity.</p>
        </section>
        
        <section>
          <h3>Unexpected correlation of browsing activity</h3>
          <p>Fingerprinting provides privacy concerns even when real-world identities are not implicated. Some users may be surprised or concerned that an online party can correlate multiple visits (on the same or different sites) to develop a profile or history of the user. This concern may be heightened because it may occur without the user's knowledge or consent and tools such as clearing cookies do not prevent or &#8220;re-set&#8221; correlation done via browser fingerprinting.</p>
          <p>Fingerprinting also allows for tracking across <a>origins</a>: different sites may be able to combine information about a single user even where a cookie policy would block accessing of the cookies between origins, because the fingerprinting is relatively unique and the same for all origins.</p>
        </section>
        
        <section>
          <h3>Inferences about a user</h3>
          <p>The observable characteristics used for browser fingerprinting can themselves reveal information from which inferences can be drawn about a user. For example, the OS version and CPU information might be used to draw inferences about a user’s purchasing power or proclivity (<a href="#wsj-orbitz">for example</a>). Users may consider this an unwelcome intrusion into their privacy even if they remain unidentified. Additionally, decisions might be made based on these inferences (e.g. which offers to display and at what price) that users perceive as discriminatory and an instance of being singled out and treated differently. This intrusion is compounded when browser fingerprints are correlated with user credentials, purchasing histories and other information about the user (e.g. cross-site browsing histories).</p>
          <p class="note">Is this in scope for browser fingerprinting? Or is this just a general privacy concern about leakage of information via observable characteristics?</p>
        </section>
    </section>
    </section>

    <section>
        <h2 id="types_of_fingerprinting">Types of fingerprinting</h2>
        <section>
          <h3 id="passive">Passive</h3>
          <p><dfn>Passive fingerprinting</dfn> is browser fingerprinting based on characteristics observable in the contents of Web requests, without the use of any code executing on the client side.</p>
          <p>Passive fingerprinting would trivially include cookies (often unique identifiers sent in HTTP requests) and the set of HTTP request headers and the IP address and other network-level information. The <a href="http://tools.ietf.org/html/rfc2616#section-14.43">User-Agent string</a>, for example, is an HTTP request header that typically identifies the browser, renderer, version and operating system. For some populations, the user agent string and IP address will commonly uniquely identify a particular user's browser [[NDSS-FINGERPRINTING]].</p>
        </section>
        <section>
          <h3 id="active">Active</h3>
          <p>For <dfn>active fingerprinting</dfn>, we also consider techniques where a site runs JavaScript or other code on the local client to observe additional characteristics about the browser. Techniques for active fingerprinting might include accessing the window size, enumerating fonts or plug-ins, evaluating performance characteristics, or rendering graphical patterns.</p>
        </section>
        <section>
          <h3 id="cookie_like_setting_retrieving_local_state">Cookie-like (setting/retrieving local state)</h3>
          <p>Users, user agents and devices may also be re-identified by a site that first sets and later retrieves state stored by a user agent or device. This <dfn>cookie-like fingerprinting</dfn> allows re-identification of a user or inferences about a user in the same way that HTTP cookies allow state management for the stateless HTTP protocol [[RFC6265]].</p>
          <p>Cookie-like fingerprinting can also circumvent user attempts to limit or clear cookies stored by the user agent, as demonstrated by the "evercookie" implementation [[EVERCOOKIE]]. Where state is maintained across user agents (as in the case of common plugins with local storage), across devices (as in the case of certain browser syncing mechanisms) or across software upgrades, cookie-like fingerprinting can allow re-identification of users, user agents or devices where active and passive fingerprinting might not.</p>
        </section>
    </section>

    <section>
      <h2 id="feasibility">Feasibility</h2>
      
      <section>
          <h2>Fingerprinting mitigation levels of success</h2>
          <p>There are different levels of success in addressing browser fingerprinting:</p>
          <dl>
          <dt>Decreased fingerprinting surface</dt><dd>Removing the source of entropy or accessible attributes that can be used for fingerprinting.</dd>
          <dt>Increased anonymity set</dt><dd>By standardization, convention or common implementation, increasing the commonality of particular configurations to decrease the likelihood of unique fingerprintability.</dd>
          <dt>Detectable fingerprinting</dt><dd>Making (in particular, client-side) fingerprinting observable to the user agent or some other party, so that the user agent might block it or a crawler can determine that it's happening.</dd>
          </dl>
      </section>
      <section>
        <h2>A lost cause?</h2>
        <p>
          Given the advances in techniques for browser fingerprinting (see the <a href="#research">Research</a> section below), particularly in active fingerprinting, many have asked whether browser fingerprinting is a "lost cause" and mitigations therefore not worth pursuing during the design process. This document works under the expectation that mitigations with different levels of success are feasible under different circumstances, for different threat models and against different types of fingerprinting. In general, active fingerprinting may be made detectable; we can minimize increases to the surface of passive fingerprinting; and cookie-like fingerprinting can be documented to enable clearing local state.
        </p>
        <p>
          However, the mitigations recommended here are simply mitigations, not solutions. Research in browser fingerprinting continues and even with the mitigations described here, users should not rely on sites being completely unable to recognize or correlate traffic, most especially when executing client-side code. A fingerprinting surface extends across all implemented Web features for a particular user agent, and even to other layers of the stack. In order to mitigate the risk as a whole, fingerprinting must be considered during the design and development of all specifications.
        </p>
        <p>
          Some implementers and some users may be willing to accept reduced functionality or decreased performance in order to minimize browser fingerprinting. Documenting which features have fingerprinting risk eases the work of implementers building modes for these at-risk users; minimizing fingerprinting even in cases where common implementations will have easy active fingerprintability allows such users to reduce the functionality trade-offs necessary.
        </p>
      </section>
    </section>
    <section>
        <h2 id="mitigations_and_guidance">Mitigations</h2>
        <section>
          <h3 id="weighing_increased_fingerprinting_surface">Weighing increased fingerprinting surface</h3>
          <p>The <dfn>fingerprinting surface</dfn> of a user agent is the set of observable characteristics that can be used in concert to identify a user, user agent or device or correlate its activity. Web specification authors regularly attempt to strike a balance between new functionality and fingerprinting surface. For example, feature detection functionality allows for progressive enhancement, but detailed granularity in feature detection increases the fingerprinting surface of a user agent. (An attacker can test for many features on every visitor's browser and might uniquely identify a user by the exact set of features enabled.)</p>
          <p>Authors and Working Groups determine the appropriate balance between these properties on a case-by-case basis, given their understanding of the functionality, its likely implementations and the entropy of increased fingerprinting surface. However, given the distinct privacy impacts described above and in order to improve consistency across specifications, the following requirements provide guidance for this balance:</p>
          
          <div class="practice">
            <p>
              <span id="avoid-passive-increases" class="practicelab">Avoid any increase to the surface for passive fingerprinting.</span>
            </p>
            <p class="practicedesc">
              Unless a feature cannot reasonably be designed in any other way, increased passive fingerprintability should be prevented.
            </p>
          </div>
          <div class="practice">
            <p>
              <span id="avoid-active-increases" class="practicelab">Prefer functionally-comparable designs that don't increase the surface for active fingerprinting.</span>
            </p>
            <p class="practicedesc">
              If comparable functionality could be accomplished without increasing the surface for active fingerprinting, prefer the less fingerprintable alternative. Defining "equivalent" or "comparable" functionality can be difficult; use your best judgment and avoid unnecessary fingerprintability.       
            </p>
          </div>
          
          <p>The difference between these practices recognizes that passive fingerprinting surface has lesser options for mitigation (lacking external detectability and client-side preventability) and greater feasibility for reduction.</p>
          
          <div class="practice">
            <p>
              <span id="mark-fingerprinting" class="practicelab">Mark features that contribute to fingerprintability.</span>
            </p>
            <p class="practicedesc">
              <img src="http://www.w3.org/TR/html5/images/fingerprint.png" class="fingerprint">
              Where a feature does contribute to the fingerprinting surface, indicate that impact, by explaining the effect (and any known implementer mitigations) and marking the relevant section with a fingerprinting icon, as this paragraph is.            
            </p>
            <p class="note">
            This practice (and this image) is drawn from the HTML5 specification, which uses it throughout. Can we get feedback from the HTML WG or from readers of that specification as to whether the practice has been useful?
            </p>
          </div>
        </section>
        <section>
			<h3 id="a_standardized_profile">A standardized profile?</h3>
			<p>
				TODO: why it would be useful to have standardized profile values, where possible
			</p>
      <p>
        TODO: why we don't typically recommend that we try to do this across user agent implementations
				... that is, why we're not advocating for getting rid of the User Agent string
			</p>
      <p>
        TODO: explain why randomization probably isn't helpful
      </p>
      <div class="practice">
        <p>
          <span id="specify-ordering" class="practicelab">Specify orderings and non-functional differences.</span>
        </p>
        <p class="practicedesc">
          To reduce unnecessary entropy, specify aspects of API return values and behavior that don't contribute to functional differences. For example, if the ordering of return values in a list has no semantic value, specify a particular ordering (alphabetical order by a defined algorithm, for example) so that incidental differences don't expose fingerprinting surface.
        </p>
      </div>
		</section>
        <section>
          <h3>Detectability</h3>
          <p>Where a client-side API provides some fingerprinting surface, authors can still mitigate the privacy concerns via detectability. If client-side fingerprinting activity is to some extent distinguishable from functional use of APIs, user agent implementations may have an opportunity to prevent ongoing fingerprinting or make it observable to users and external researchers (including academics or relevant regulators) who may be able to detect and investigate the use of fingerprinting.</p>
          
          <div class="practice">
            <p>
              <span id="api-minimization" class="practicelab">Design APIs to access only the entropy necessary.</span>
            </p>
            <p class="practicedesc">
              Following the basic principle of <a>data minimization</a>, design your APIs such that a site can access (and does access by default) only the entropy necessary for particular functionality.
            </p>
            <p class="note">TODO: An example would probably be very useful here.</p>
          </div>     
          
          <div class="practice">
            <p>
              <span id="anticipate-disabled" class="practicelab">Anticipate disabled functionality for the fingerprinting-conscious.</span>
            </p>
            <p class="practicedesc">
              If your specification exposes some fingerprinting surface (whether it's active or passive), some implementers (e.g. the Tor Browser) are going to be compelled to disable those features for certain privacy-conscious users. Following the principle of <a>progressive enhancement</a>, and to avoid further divergence (which might itself expose variation in users), consider whether some functionality in your specification is still possible if fingerprinting surface features are disabled. 
            </p>
          </div>     
        </section>
        <section>
          <h3>Clearing all local state</h3>
          <p>Features which enable storage of data on the client and functionality for client- or server-side querying of that data can increase the ease of cookie-like fingerprinting. Storage can vary between large amounts of data (for example, the Web Storage API) or just a binary flag (has or has not provided a certain permission; has or has not cached a single resource).</p>
          <div class="practice">
            <p>
              <span id="no-new-cookies" class="practicelab">Avoid new cookie-like local state mechanisms.</span>
            </p>
            <p class="practicedesc">
              If functionality does not require maintaining client-side state in a way that is subsequently queryable (or otherwise observable), avoid creating a new cookie-like feature. Can the functionality be accomplished with existing HTTP cookies or an existing JavaScript local storage API?
            </p>
          </div>
          <p>Where features do require setting and retrieving local state, there are ways to mitigate the privacy impacts related to unexpected cookie-like behavior; in particular, you can help implementers prevent "permanent", "zombie" or "evercookies".</p>
          <div class="practice">
            <p>
              <span id="mark-cookie-like" class="practicelab">Highlight any local state mechanisms to enable simultaneous clearing.</span>
            </p>
            <p class="practicedesc">
              Clearly note where state is being maintained and could be queried and provide guidance to implementers on enabling simultaneous deletion of local state for users. Such functionality can mitigate the threat of "evercookies"  because the presence of state in one such storage mechanism can't be used to persist and re-create an identifier. As a result, your design should not rely on saving and later querying data on the client beyond a user's clearing all local state. That is, you should not expect any local state information to be permanent.
            </p>
          </div>
          <p>Though not strictly browser fingerprinting, there are other privacy concerns regarding user tracking for features that provide local storage of data. Mitigations suggested in the Web Storage API specification include: white-listing, black-listing, expiration and secure deletion [[WEBSTORAGE-user-tracking]].</p>
        </section>
        <section><h3 id="do_not_track_a_cooperative_approach">Do Not Track: a cooperative approach</h3>
          <p>Expressions of, and compliance with, a Do Not Track signal may not prevent or inhibit browser fingerprinting, but may mitigate some user concerns about fingerprinting, specifically around tracking as defined in those specifications [[TRACKING-DNT]] [[TRACKING-COMPLIANCE]] and as implemented by services engaged in fingerprinting that voluntarily comply with those user preferences.</p>
          
          <p>This mitigation is included here for completeness: DNT standardization and adoption is ongoing. The use of DNT in this way should not require any work for your specification, unless for some reason you need to specify a certain specific DNT behavior for your functionality.</p>
        </section>
    </section>
    
    <section>
        <h2 id="research">Research</h2>
        <p><em>Some browser developers maintain pages on browser fingerprinting, including: potential mitigations or modifications necessary to decrease the surface of that browser engine; different vectors that can be used for fingerprinting; potential future work. These are not cheery, optimistic documents.</em></p>
        <ul>
          <li>Janc, Artur and Michal Zalewski. "<a href="https://sites.google.com/a/chromium.org/dev/Home/chromium-security/client-identification-mechanisms#TOC-Fingerprinting-prevention-and-detection-challenges">Technical analysis of client identification mechanisms</a>". The Chromium Projects.</li>
          <li><a href="https://trac.webkit.org/wiki/Fingerprinting">WebKit Wiki: Fingerprinting</a></li>
          <li><a href="https://wiki.mozilla.org/Fingerprinting">Mozilla Wiki: Fingerprinting</a></li>
        </ul>
        
        <p><em>What are the key papers to read here, historically or to give the latest on fingerprinting techniques? What are some areas of open research that might be relevant?</em></p>
        <ul>
          <li>Eckersley, Peter. "<a href="https://panopticlick.eff.org/browser-uniqueness.pdf">How unique is your web browser?</a>" <i>Privacy Enhancing Technologies</i>. Springer Berlin Heidelberg, 2010.</li>
          <li>Yen, Ting-Fang, et al. "<a href="http://www.rsasecurity.ch/rsalabs/staff/bios/tfyen/publications/NDSS12-HostTracking.pdf">Host fingerprinting and tracking on the web: Privacy and security implications</a>." <em>Proceedings of NDSS</em>. 2012.</li>
          <li>Mowery, Keaton, and Hovav Shacham. "Pixel perfect: Fingerprinting canvas in HTML5." <em>Proceedings of W2SP</em> (2012).</li>
          <li>Mowery, Keaton, Dillon Bogenreif, Scott Yilek, and Hovav Shacham. “<a href="http://w2spconf.com/2011/papers/jspriv.pdf">Fingerprinting Information in JavaScript Implementations</a>.” In Web 2.0 Security and Privacy, 2011.</li>
          <li id="wsj-orbitz">Mattioli, Dana. "<a href="http://online.wsj.com/article/SB10001424052702304458604577488822667325882.html">On Orbitz, Mac Users Steered to Pricier Hotels</a>". Wall Street Journal, August 23, 2012.</li>
          <li id="FPDetective">Gunes Acar et al. "<a href="http://dl.acm.org/citation.cfm?id=2516674">FPDetective: dusting the web for fingerprinters</a>." In CCS '13 Proceedings of the 2013 ACM SIGSAC conference on Computer &amp; communications security.</li>
          <li>Nikiforakis, Nick, et al. "<a href="http://seclab.cs.ucsb.edu/media/uploads/papers/sp2013_cookieless.pdf">Cookieless monster: Exploring the ecosystem of web-based device fingerprinting</a>." IEEE Symposium on Security and Privacy. 2013.</li>
        </ul>
        
        <h3>Testing</h3>
        <p><em>A non-exhaustive list of sites that allow the visitor to test their configuration for fingerprintability.</em></p>
        <ul>
          <li><a href="https://amiunique.org/">amiunique.org</a> (INRIA)</li>
          <li><a href="https://panopticlick.eff.org/">panopticlick.eff.org</a> (EFF)</li>
          <li><a href="http://browserspy.dk/">BrowserSPY.dk</a></li>
          <li><a href="http://lcamtuf.coredump.cx/p0f3/">p0f v3</a> (purely passive fingerprinting)</li>
        </ul>
    </section>    
    
    <section class='appendix'>
      <h2>Acknowledgements</h2>
      <p>
        Many thanks to Robin Berjon for ReSpec and to Tobie Langel for Github advice; to the <a href="http://www.w3.org/Privacy/">Privacy Interest Group</a> for review; and to Christine Runnegar for contributions.
      </p>
    </section>
  </body>
</html>